function m(e){console.log(e)}function $post(e,o,a,i){commonAjax("post",e,o,a,i)}function $get(e,o,a,i){commonAjax("get",e,o,a,i)}function tip(e){$t.html(e),isTipHide()&&($t.show(),setTimeout(function(){$t.hide()},2e3))}function isTipHide(){return"none"===$t.css("display")}function openLoading(e){var o=$("#loadingToast");0===o.length&&$(e).append('<div id="loadingToast"><div class="weui-mask_transparent"></div><div class="weui-toast"><i class="weui-loading weui-icon_toast"></i><p class="weui-toast__content">数据加载中</p></div></div>')}function closeLoading(){$("#loadingToast").remove()}function showSuccess(e,o){closeLoading(),$(e).append('<div class="is-show-success"><div class="weui-mask_transparent"></div><div class="weui-toast"><i class="weui-icon-success-no-circle weui-icon_toast"></i><p class="weui-toast__content">已完成</p></div></div>'),setTimeout(function(){$(".is-show-success").remove(),o&&o()},1111)}function set(e,o){localStorage.setItem(e,JSON.stringify(o))}function get(e){localStorage.getItem(e);return{id:1,game_type:1,account:"test1234",level:"0",room_card:0,create_date:"2017-05-08",status:0,next_proxy_count:16,realname:"fenny"}}function isLogin(e){proxy=get("proxy"),$.isEmptyObject(proxy)?window.pageManager.go("login"):e()}function isManager(){return 0==proxy.level}function getRoomCard(){return isManager()?"无限":proxy.room_card}function getLevel(){return syscode.level[proxy.level]}function setRoomCard(e){isManager()||(proxy.room_card=proxy.room_card+e,set("proxy",proxy))}function loadMore(e,o){$(e).append('<div class="weui-cell" id="load-more"><div class="weui-cell__bd"><p class="page__desc is-text-center">加载更多</p></div></div>'),$("#load-more").on("click",function(){$(this).remove(),o()})}function loadMoreBegin(e){$(e).append('<div class="weui-loadmore" id="load-more-begin"><i class="weui-loading"></i><span class="weui-loadmore__tips">正在加载</span></div>')}function loadMoreNo(e){$("#load-more").remove(),$("#load-more-begin").remove(),$(e).append('<div class="weui-loadmore weui-loadmore_line" id="load-more-no"><span class="weui-loadmore__tips">暂无数据</span></div>')}function initHome(){proxy=get("proxy"),$.isEmptyObject(proxy)?($("#home-next-proxy-count").html(""),$("#home-proxy-level").html(""),$("#home-room-card").html("")):($("#home-next-proxy-count").html(proxy.next_proxy_count),$("#home-proxy-level").html(getLevel()),$("#home-room-card").html(getRoomCard()))}function dialog(e,o){var a='<div class="js_dialog dialog-tip" id="show-dialog"><div class="weui-mask"></div><div class="weui-dialog"><div class="weui-dialog__bd">'+e+'</div><div class="weui-dialog__ft"><a href="javascript:;" class="weui-dialog__btn weui-dialog__btn_primary" id="show-dialog-confirm">确认</a></div></div></div>';$("body").append(a),$("#show-dialog-confirm").on("click",function(){$("#show-dialog").remove(),o&&o()})}var requestId,nextProxyId,regs={account:{reg:/^[a-zA-Z][-_a-zA-Z0-9]{5,19}$/,msg:"仅支持6-20个字母、数字、下划线或减号以字母开头"},password:{reg:/^\w{6,30}$/,msg:"密码格式错误"},imgCode:{reg:/^\w{4,6}$/,msg:"图形验证码长度4-6位"},realname:{reg:/^.{1,10}$/,msg:"姓名长度1-10"},mobile:{reg:/^\d{11}$/,msg:"手机号格式错误"}};!function(e,o){var a="";e.imageCode=a+"imageCode/get.do",e.login=a+"proxy/login.do",e.resetPwd=a+"proxy/resetPwd.do",e.roomCardRecordPage=a+"proxy/roomCardRecordPage.do",e.proxyPage=a+"proxy/proxyPage.do",e.upCard=a+"proxy/upCard.do",e.downCard=a+"proxy/downCard.do",e.playerRecharge=a+"proxy/playerRecharge.do",e.esc=a+"proxy/esc.do",e.addProxy=a+"proxy/add.do",e.sms=a+"sms/send.do",e.requestProxy=a+"proxy/request.do",e.requestPage=a+"proxy/requestPage.do",e.requestDetail=a+"proxy/requestDetail.do",e.updateStatus=a+"proxy/updateStatus.do",e.detail=a+"proxy/detail.do",o.gameType={1:"麻将",2:"字牌",3:"纸牌"},o.type={0:"上卡",1:"下卡",2:"充值"},o.status={0:"禁用",1:"正常",2:"审核中",3:"已拒绝"},o.level={0:"顶级",1:"1级",2:"2级",3:"3级"}}(window.paths={},window.syscode={});var commonAjax=function(e,o,a,i,t){$.ajax({url:o+"?t="+(new Date).getTime(),data:a,dataType:"json",type:e,timeout:1e4,success:function(e){0===e.status?i(e):"000004"===e.code?(localStorage.clear(),tip(e.message),window.pageManager.go("login")):t?t(e):tip(e.message),closeLoading()},error:function(e,o,a){tip("网络不佳"),closeLoading()}})},$t=$(".js_tooltips"),proxy,requestList=function(e){var o,a,i,t=function(){o=0,a=20,i=0,$(e).html(""),r()},r=function(){var o={limit:a};o.offset=(++i-1)*a,loadMoreBegin(e),$get(paths.requestPage,o,function(o){$("#load-more-begin").remove();for(var i=0;i<o.rows.length;i++){var t=o.rows[i],s=$("#request-list-template").html();s=s.replace(/{id}/g,t.id),s=s.replace(/{realname}/g,t.realname),s=s.replace(/{create_date}/g,t.create_date),s=s.replace(/{mobile}/g,t.mobile),s=s.replace(/{status}/g,syscode.status[t.status]),$(e).append(s)}o.rows.length<a?loadMoreNo(e):loadMore(e,function(){r()}),$(e).find("a[data-id]").on("click",function(){requestId=$(this).data("id"),window.pageManager.go("request_proxy_detail")})})};return{reload:t}}("#request-list"),proxyList=function(e){var o,a,i,t=function(){o=0,a=20,i=0,$(e).html(""),r()},r=function(){var o={limit:a};o.offset=(++i-1)*a,loadMoreBegin(e),$get(window.paths.proxyPage,o,function(o){$("#load-more-begin").remove();for(var i=0;i<o.rows.length;i++){var t=o.rows[i],s=$("#proxy-list-template").html();s=s.replace(/{id}/g,t.id),s=s.replace(/{name}/g,t.realname),s=s.replace(/{mobile}/g,t.mobile),s=s.replace(/{status}/g,syscode.status[t.status]),s=s.replace(/{room_card}/g,t.room_card),$(e).append(s)}o.rows.length<a?loadMoreNo(e):loadMore(e,function(){r()}),$(e).find("a[data-id]").on("click",function(){nextProxyId=$(this).data("id"),window.pageManager.go("proxy_detail")})})};return{reload:t}}("#proxy-list-range"),homePage=function(e){var o='<a href="javascript:" id="request-proxy-list-page" data-id="request_proxy_list" class="weui-grid"><div class="weui-grid__icon"><i class="iconfont icon-request-list is-color-d98837"></i></div><p class="weui-grid__label">申请列表</p></a>',a=function(){if(initHome(),isManager()){var a=$("#request-proxy-list-page");0===a.length&&$(e).find('a[data-id="player_recharge"]').after(o)}$(e).find("a[data-id]").on("click",function(){window.pageManager.go($(this).data("id"))}),$(e).find(".esc").on("click",function(){$.get(window.paths.esc),localStorage.clear(),window.pageManager.go("login")})};return{init:a}}("#home");$(window).on("popstate",function(){var e=location.hash,o=e.split("#!/"),a=o[1];if(""!==a){var i=window.location.hash;switch(i){case"":isLogin(homePage.init);break;case"#request_proxy_list":isLogin(requestList.reload);break;case"#proxy_list":isLogin(proxyList.reload)}}});